[Auto-diff] Overhaul auto-diff type tracking + Overhaul dynamic dispatch for differentiable functions (#5866)
87f00a36a123e36b415eeea82e02a8366cc5b881
