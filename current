Bring back hooks for auto formatting and ensure build works (#7811)
2d775b54d2ab7772785c2196075d4c7c174407ab
