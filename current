Revert "Reduce the dependency to thread library (#8216)" (#8319)
74c39eaa3dbd6ca55a383afca51ec18962838f08
