Lookup refactor (#8467)
21c663605330d629e9022314a4720b86b017f295
